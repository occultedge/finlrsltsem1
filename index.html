 <!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Result Portal</title>
  <style>
  /* Funnel container */
  .funnel-container {
    width: 100%;
    height: 20px;
    background-color: #ddd;
    margin-top: 20px;
    border-radius: 10px;
    overflow: hidden;
    display: none;  /* Initially hidden */
  }

/\* Funnel fill animation */
.funnel-fill {
height: 100%;
width: 0%;  /* Starts empty */
background-color: #4CAF50;
border-radius: 10px;
transition: width 2s ease-out;  /* Smooth transition for funnel fill \*/
}

body {
font-family: Arial, sans-serif;
background-color: #f4f4f4;
padding: 20px;
}

.container {
width: 50%;
margin: 0 auto;
padding: 20px;
background-color: white;
box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
border-radius: 10px;
}

h1 {
text-align: center;
}

select, input, button {
width: 100%;
padding: 10px;
margin: 10px 0;
font-size: 16px;
border-radius: 5px;
border: 1px solid #ccc;
}

button {
background-color: #4CAF50;
color: white;
cursor: pointer;
}

button\:hover {
background-color: #45a049;
}

.result {
margin-top: 20px;
padding: 10px;
background-color: #e0ffe0;
border: 1px solid #4CAF50;
display: none;
}

.error {
margin-top: 20px;
padding: 10px;
background-color: #ffe0e0;
border: 1px solid #f44336;
display: none;
} </style>

</head>
<body>

  <div class="container">
    <h1>Students Final Result Semester-1 </h1>

```
<label for="name">Select Your Name:</label>
<select id="name">
  <option value="">Select your name</option>
 
  <option value="ABOUDOU BELINGA GLADYS">ABOUDOU BELINGA GLADYS</option>
  <option value="ACHILLE ARISTIDE NDEBI">ACHILLE ARISTIDE NDEBI</option>
  <option value="ACHONGWA EMILIO AZEH">ACHONGWA EMILIO AZEH</option>
  <option value="AICHATOU MOHAMADOU">AICHATOU MOHAMADOU</option>
  <option value="ASAMYAME JOHNSON">ASAMYAME JOHNSON</option>
  <option value="ATEYIM THERESIA">ATEYIM THERESIA</option>
  <option value="AWAFONG SANDRA">AWAFONG SANDRA</option>
  <option value="AWAH DESTINY NJI">AWAH DESTINY NJI</option>
  <option value="AYUK ENO WHITNEY">AYUK ENO WHITNEY</option>
  <option value="BANGWEN BIKOY STEVE B">BANGWEN BIKOY STEVE B</option>
  <option value="BEYALA TINA DIANA">BEYALA TINA DIANA</option>
  <option value="CHAKA LEHNA ANU C">CHAKA LEHNA ANU C</option>
  <option value="CLARENCE BERINYUY">CLARENCE BERINYUY</option>
  <option value="EKINDE MEKOLLE MUKEA">EKINDE MEKOLLE MUKEA</option>
  <option value="EUPHRENCIA BI">EUPHRENCIA BI</option>
  <option value="KIEN RILIBDIS ANYE">KIEN RILIBDIS ANYE</option>
  <option value="KIKWI PETRA">KIKWI PETRA</option>
  <option value="KINUY PRECIOUS">KINUY PRECIOUS</option>
  <option value="KUDI ERASMUS OTEH">KUDI ERASMUS OTEH</option>
  <option value="KWILABUN DOREEN NGONFAS">KWILABUN DOREEN NGONFAS</option>
  <option value="LEDRU RAYMOND MICHAEL">LEDRU RAYMOND MICHAEL</option>
  <option value="MAFOLAC MESSANGA">MAFOLAC MESSANGA</option>
  <option value="MAMBA NGOY CONSTANT">MAMBA NGOY CONSTANT</option>
  <option value="MBAKEM STEOHANY MALLE">MBAKEM STEOHANY MALLE</option>
  <option value="MBOM BONGJOH NOELLA">MBOM BONGJOH NOELLA</option>
  <option value="MC EDWARD A">MC EDWARD A</option>
  <option value="MOSAMA AUINOLINE">MOSAMA AUINOLINE</option>
  <option value="NCHOTU MAVET ABINGHA">NCHOTU MAVET ABINGHA</option>
  <option value="NDZINENG CHELCY">NDZINENG CHELCY</option>
  <option value="NEBA FAVOUR BIH">NEBA FAVOUR BIH</option>
  <option value="NGONG MARINUS LENDZELE">NGONG MARINUS LENDZELE</option>
  <option value="NGWAIN DOLEN">NGWAIN DOLEN</option>
  <option value="NKAMENI TCHIO STADILE">NKAMENI TCHIO STADILE</option>
  <option value="NSOUANFOUO NZEGAH FRENEL">NSOUANFOUO NZEGAH FRENEL</option>
  <option value="NOUNKEU YIMGA ELVIRA">NOUNKEU YIMGA ELVIRA</option>
  <option value="NSOM KELLY FULAI">NSOM KELLY FULAI</option>
  <option value="NUELLA NANGE">NUELLA NANGE</option>
  <option value="ONDIKE GLADYS MOKABWE">ONDIKE GLADYS MOKABWE</option>
  <option value="PRECIOUS FAITH AFANWI">PRECIOUS FAITH AFANWI</option>
  <option value="SONG JERRY AFUMA">SONG JERRY AFUMA</option>
  <option value="TAMUFOR JULIENNE NING">TAMUFOR JULIENNE NING</option>
  <option value="TAYO QUINIVETTE EWO">TAYO QUINIVETTE EWO</option>
  <option value="TEMGOUA TCHANGOUE GEORGY L">TEMGOUA TCHANGOUE GEORGY L</option>
  <option value="TENDONG GLENDA">TENDONG GLENDA</option>
  <option value="TIZEE QUINTAR ANYAM N">TIZEE QUINTAR ANYAM N</option>
  <option value="TOH EINSTEIN">TOH EINSTEIN</option>
  <option value="TOHMAN EPHISIAN BI">TOHMAN EPHISIAN BI</option>
  <option value="Sijinge Juliet Mensiy">Sijinge Juliet Mensiy</option>
  <option value="Mbom Bongjoh Trene Kuboh">Mbom Bongjoh Trene Kuboh</option>
  <option value="NJIKETOMMY STEVE WILFRED">NJIKETOMMY STEVE WILFRED</option>
```

<option value="azefackdanellelucresse">azefackdanellelucresse</option>
<option value="NGA BELINGAMARIE">NGA BELINGAMARIE</option>
<option value="NGUEVOUANGE">NGUEVOUANGE</option>
<option value="SIMOSTEVINE">SIMOSTEVINE</option>
<option value="MBIANDUNKOUAMOU JOSSINET">MBIANDUNKOUAMOU JOSSINET</option>
<option value="KENFACKSTEPHY LESTERONE">KENFACKSTEPHY LESTERONE</option>
<option value="TekuEwah">TekuEwah</option>
<option value="kongnyuyHARIRATU">kongnyuyHARIRATU</option>
<option value="BanRuth Stevie Miltread">BanRuth Stevie Miltread</option>
<option value="RAYE NJIFENNAHIMA">RAYE NJIFENNAHIMA</option>
<option value="BAKWOWISTELLA">BAKWOWISTELLA</option>
<option value="fonjomidrate">fonjomidrate</option>
<option value="LincyNgoh">LincyNgoh</option>
<option value="Mbom-BongjohIrene Kuboh">Mbom-BongjohIrene Kuboh</option>
<option value="lokengloic jinoir">lokengloic jinoir</option>
<option value="MosamaMaloba">MosamaMaloba</option>
<option value="AyukEnow Whitney Ashley Eyong">AyukEnow Whitney Ashley Eyong</option>
<option value="nforbelinda aba">nforbelinda aba</option>
<option value="SongNkwainchi">SongNkwainchi</option>
<option value="tamuntingdanila">tamuntingdanila</option>
<option value="BEBITELAURA KHAN">BEBITELAURA KHAN</option>
<option value="Ekinde MekolleMuke Queenie-l'or">Ekinde MekolleMuke Queenie-l'or</option>
<option value="BakwowiStella">BakwowiStella</option>
<option value="ayah rashaelanne">ayah rashaelanne</option>
<option value="NkamenyiStadile">NkamenyiStadile</option>
<option value="pangwa kemayoumariane carene">pangwa kemayoumariane carene</option>

```
</select>

<label for="password">Enter Your Password:</label>
<input type="text" id="password" placeholder="Enter your password">

<button onclick="getStudentResults()">Get My Results</button>

<div class="result" id="result"></div>
<!-- Certificate Download Button -->
<button id="downloadBtn" style="display:none;" onclick="downloadCertificate()">Download Certificate</button>

<div class="error" id="error"></div>
```

  </div>

  <!-- Funnel animation container -->

  <div class="funnel-container" id="funnel">
    <div class="funnel-fill" id="funnel-fill"></div>
  </div>

 <!-- Include jsPDF -->
<!-- Include jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
  let studentResultData = null;

  function getStudentResults() {
    const studentName = document.getElementById('name').value.trim();
    const studentPassword = document.getElementById('password').value.trim();

    if (!studentName || !studentPassword) {
      alert("Please enter both name and password.");
      return;
    }

    document.getElementById('funnel').style.display = 'block';
    document.getElementById('funnel-fill').style.width = '0%';
    setTimeout(() => {
      document.getElementById('funnel-fill').style.width = '100%';
    }, 100);

    const url = 'https://script.google.com/macros/s/AKfycbzKIw5YmdWP4nS8KyVVhiN3XEgVnBmq59_lYo3BtI079oCzVKtCjFoIR2R8-859bxnU/exec' +
                '?name=' + encodeURIComponent(studentName) +
                '&password=' + encodeURIComponent(studentPassword);

    fetch(url)
      .then(response => response.json())
      .then(data => {
        if (data.results) {
          studentResultData = {
            name: studentName,
            results: data.results
          };

          let resultHtml = "Your Final Result Semester 1:<br><ul>";
          for (let subject in data.results) {
            resultHtml += `<li><strong>${subject}:</strong> ${data.results[subject]}</li>`;
          }
          resultHtml += "</ul>";

          document.getElementById('result').style.display = 'block';
          document.getElementById('result').innerHTML = resultHtml;
          document.getElementById('error').style.display = 'none';
          document.getElementById('downloadBtn').style.display = 'block';
        } else {
          document.getElementById('error').style.display = 'block';
          document.getElementById('error').innerHTML = data.error || "Incorrect credentials.";
          document.getElementById('result').style.display = 'none';
          document.getElementById('downloadBtn').style.display = 'none';
        }

        document.getElementById('funnel').style.display = 'none';
      })
      .catch(() => {
        document.getElementById('error').style.display = 'block';
        document.getElementById('error').innerHTML = "An error occurred. Please try again later.";
        document.getElementById('result').style.display = 'none';
        document.getElementById('funnel').style.display = 'none';
      });
  }

  async function downloadCertificate() {
    const inputPassword = prompt("Enter password to download your certificate:");

    if (inputPassword !== "drnsai") {
      alert("Incorrect password. Please contact your administrator.");
      return;
    }

    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Background color
    doc.setFillColor(240, 248, 255); // Light blue
    doc.rect(0, 0, 210, 297, 'F');

    // Border
    doc.setDrawColor(0, 102, 204);
    doc.setLineWidth(2);
    doc.rect(10, 10, 190, 277);

    // Logos
    const logo1 = await loadImageAsBase64("https://static.wixstatic.com/media/22a959_2a8250afd0d64ed3bdfe4cbf1fd81d5c~mv2.png");
    const logo2 = await loadImageAsBase64("https://static.wixstatic.com/media/eb9038_02101a65bf874877aab12432fb4f215a~mv2.jpg");
    if (logo1) doc.addImage(logo1, 'png', 50, 25, 40, 25);
    if (logo2) doc.addImage(logo2, 'jpg', 110, 25, 40, 25);

    // Title
    doc.setFont("times", "bolditalic");
    doc.setFontSize(26);
    doc.setTextColor(0, 102, 153);
    doc.text("Certificate of Achievement", 105, 60, null, null, "center");

    // Subtitle
    doc.setFontSize(16);
    doc.setTextColor(50, 50, 50);
    doc.text("This is to proudly certify that", 105, 70, null, null, "center");

    // Student Name
    doc.setFontSize(20);
    doc.setTextColor(0, 0, 0);
    doc.text(studentResultData.name, 105, 80, null, null, "center");
    doc.line(55, 85, 155, 85); // underline

    // Certification text
    doc.setFontSize(14);
    doc.text("has successfully completed Semester 1 with the following results:", 105, 90, null, null, "center");

    // Results
    doc.setFont("helvetica", "normal");
    let y = 100;
    for (let subject in studentResultData.results) {
      doc.text(subject, 50, y);
      doc.text(`${studentResultData.results[subject]}`, 160, y, null, null, "right");
      y += 7;
    }

    // Motivation
    doc.setFontSize(12);
    doc.setTextColor(80, 80, 80);
    doc.text("Keep up the great work and continue striving for excellence!", 105, y + 15, null, null, "center");

    // Signature
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    doc.text("_________________________", 40, 260);
    doc.text("Authorized Signature", 40, 267);

   

    doc.save(`${studentResultData.name.replace(/\s+/g, '_')}_Certificate.pdf`);
  }

  async function loadImageAsBase64(url) {
    try {
      const response = await fetch(url);
      const blob = await response.blob();
      return await new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onloadend = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsDataURL(blob);
      });
    } catch (e) {
      console.error("Failed to load image:", e);
      return null;
    }
  }
</script>

 
</body>
</html>
